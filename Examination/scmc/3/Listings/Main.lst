C51 COMPILER V9.60.0.0   MAIN                                                              10/23/2022 18:29:17 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\Main.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE Main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\Main
                    -.lst) TABS(2) OBJECT(.\Objects\Main.obj)

line level    source

   1          #include "REG52.H"
   2          
   3          // general
   4          #define uchar unsigned char
   5          #define uint unsigned int
   6          
   7          #define direction int
   8          #define left 0
   9          #define right 1
  10          
  11          void delay(int millis)
  12          {
  13   1          int i, j;
  14   1          for (i = 0; i < millis; i++)
  15   1          {
  16   2              for (j = 0; j < 11; j++)
  17   2                  ;
  18   2          }
  19   1      }
  20          
  21          // LED
  22          uchar LED = 0x7f;
  23          uint T = 2; // sec
  24          direction dir = right;
  25          
  26          // 键盘
  27          sbit faster = P3 ^ 0;
  28          sbit slower = P3 ^ 1;
  29          sbit cd = P3 ^ 2;
  30          
  31          void checkKey()
  32          {
  33   1          if (!faster)
  34   1          {
  35   2              delay(2);
  36   2      
  37   2              if (!faster)
  38   2              {
  39   3                  if (T > 1)
  40   3                  {
  41   4                      T--;
  42   4                  }
  43   3                  while (!faster)
  44   3                      ;
  45   3              }
  46   2          }
  47   1          else if (!slower)
  48   1          {
  49   2              delay(2);
  50   2      
  51   2              if (!slower)
  52   2              {
  53   3                  if (T < 4)
  54   3                  {
C51 COMPILER V9.60.0.0   MAIN                                                              10/23/2022 18:29:17 PAGE 2   

  55   4                      T++;
  56   4                  }
  57   3                  while (!slower)
  58   3                      ;
  59   3              }
  60   2          }
  61   1          else if (!cd)
  62   1          {
  63   2              delay(2);
  64   2              if (!cd)
  65   2              {
  66   3                  dir = (dir == left) ? right : left;
  67   3                  while (!cd)
  68   3                      ;
  69   3              }
  70   2          }
  71   1      }
  72          
  73          // 数码管
  74          sbit dula = P2 ^ 6;
  75          sbit wela = P2 ^ 7;
  76          
  77          uchar code numbers[] = {
  78              0x3F, // "0"
  79              0x06, // "1"
  80              0x5B, // "2"
  81              0x4F, // "3"
  82              0x66, // "4"
  83          };
  84          
  85          void showSpeed()
  86          {
  87   1          wela = 1;
  88   1          P0 = 0xfe;
  89   1          wela = 0;
  90   1          dula = 1;
  91   1          P0 = numbers[T];
  92   1          dula = 0;
  93   1      }
  94          
  95          void Breeze()
  96          {
  97   1          int i;
  98   1          checkKey();
  99   1          showSpeed();
 100   1          // go lighter in 1 sec
 101   1          for (i = 1; i <= 100; i++)
 102   1          {
 103   2      
 104   2              P1 = LED;
 105   2              delay(T * i);
 106   2              P1 = 0xff;
 107   2              delay(100 - T * i);
 108   2              checkKey();
 109   2              showSpeed();
 110   2          }
 111   1          P1 = 0xff;
 112   1          // go dark in 1 sec
 113   1          for (i = 1; i <= 100; i++)
 114   1          {
 115   2      
 116   2              P1 = LED;
C51 COMPILER V9.60.0.0   MAIN                                                              10/23/2022 18:29:17 PAGE 3   

 117   2              delay(100 - T * i);
 118   2              P1 = 0xff;
 119   2              delay(T * i);
 120   2              checkKey();
 121   2              showSpeed();
 122   2          }
 123   1          if (dir == right && LED != 0xfe)
 124   1          {
 125   2              LED = LED >> 1;
 126   2              LED = LED | 0x80;
 127   2          }
 128   1          else if (LED == 0xfe)
 129   1          {
 130   2              dir = left;
 131   2              LED = LED << 1;
 132   2              LED = LED | 0x01;
 133   2          }
 134   1          else if (LED == 0x7f)
 135   1          {
 136   2              dir = right;
 137   2              LED = LED >> 1;
 138   2              LED = LED | 0x80;
 139   2          }
 140   1          else if (dir == left && LED != 0x7f)
 141   1          {
 142   2              LED = LED << 1;
 143   2              LED = LED | 0x01;
 144   2          }
 145   1          checkKey();
 146   1          showSpeed();
 147   1      }
 148          
 149          void main()
 150          {
 151   1          while (1)
 152   1          {
 153   2              Breeze();
 154   2          }
 155   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    392    ----
   CONSTANT SIZE    =      5    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      5       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
